var source = {"header":{"code":"10000","app":"kbpos-shops","message":null,"subCode":null,"subMessage":null,"type":null,"errTrace":null,"ext":null,"stackTraceElements":[{"methodName":"success","fileName":"RestResponse.java","lineNumber":213,"className":"com.yazuo.framework.commons.response.RestResponse","nativeMethod":false}]},"body":[{"id":18061400012,"name":"朱嘉瑜","parentId":null,"orgType":0,"disabled":false,"checked":false,"alipStoId":"1000029","path":[18061400012],"checkedStoreIds":[],"allStoreIds":[18061400015,18061400014,18061400013],"checkedNum":0,"allNum":3},{"id":18061400013,"name":"朱嘉瑜的烧烤店(仅供测试)","parentId":18062000005,"orgType":121,"disabled":false,"checked":false,"alipStoId":"2017102500077000000046117164","path":[18061400012,18062000005,18061400013],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400014,"name":"朱嘉瑜的火锅店(仅供测试)","parentId":18062000097,"orgType":121,"disabled":false,"checked":false,"alipStoId":"2017102500077000000046112395","path":[18061400012,18062000097,18061400014],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400015,"name":"朱嘉瑜的烤鱼店(仅供测试)","parentId":18061400029,"orgType":121,"disabled":false,"checked":false,"alipStoId":"2017102500077000000046107659","path":[18061400012,18061400024,18061400025,18061400026,18061400029,18061400015],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400016,"name":"东南大区","parentId":18061400012,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000054","path":[18061400012,18061400016],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400017,"name":"行彦测试部门修改","parentId":18061400012,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000057","path":[18061400012,18061400017],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400018,"name":"二级测试部门","parentId":18061400017,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000062","path":[18061400012,18061400017,18061400018],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400019,"name":"预发测试部门","parentId":18061400012,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000073","path":[18061400012,18061400019],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400020,"name":"预发二级部门","parentId":18061400019,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000075","path":[18061400012,18061400019,18061400020],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400021,"name":"预发三级部门","parentId":18061400020,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000078","path":[18061400012,18061400019,18061400020,18061400021],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400022,"name":"预发四级部门","parentId":18061400021,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000081","path":[18061400012,18061400019,18061400020,18061400021,18061400022],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400023,"name":"预发第二次五级部门","parentId":18061400022,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000103","path":[18061400012,18061400019,18061400020,18061400021,18061400022,18061400023],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400024,"name":"眉黛二级部门test","parentId":18061400012,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000106","path":[18061400012,18061400024],"checkedStoreIds":[],"allStoreIds":[18061400015],"checkedNum":0,"allNum":1},{"id":18061400025,"name":"眉黛三级部门","parentId":18061400024,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000109","path":[18061400012,18061400024,18061400025],"checkedStoreIds":[],"allStoreIds":[18061400015],"checkedNum":0,"allNum":1},{"id":18061400026,"name":"眉黛四级部门","parentId":18061400025,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000111","path":[18061400012,18061400024,18061400025,18061400026],"checkedStoreIds":[],"allStoreIds":[18061400015],"checkedNum":0,"allNum":1},{"id":18061400027,"name":"眉黛五级部门","parentId":18061400026,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000114","path":[18061400012,18061400024,18061400025,18061400026,18061400027],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400028,"name":"眉黛六级部门test","parentId":18061400027,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000118","path":[18061400012,18061400024,18061400025,18061400026,18061400027,18061400028],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061400029,"name":"眉黛五级部门test1","parentId":18061400026,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000120","path":[18061400012,18061400024,18061400025,18061400026,18061400029],"checkedStoreIds":[],"allStoreIds":[18061400015],"checkedNum":0,"allNum":1},{"id":18061400030,"name":"眉黛六级部门test1","parentId":18061400029,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1000123","path":[18061400012,18061400024,18061400025,18061400026,18061400029,18061400030],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061401372,"name":"测试部分们1","parentId":18061400016,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1002867","path":[18061400012,18061400016,18061401372],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061900005,"name":"辰森供应链测试_中央厨房","parentId":18061400029,"orgType":125,"disabled":false,"checked":false,"alipStoId":"1004009","path":[18061400012,18061400024,18061400025,18061400026,18061400029,18061900005],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061900071,"name":"111111","parentId":18061400019,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1005885","path":[18061400012,18061400019,18061900071],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061900072,"name":"aa45","parentId":18061400016,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1005889","path":[18061400012,18061400016,18061900072],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061900073,"name":"2222","parentId":18061400016,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1005927","path":[18061400012,18061400016,18061900073],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18061900084,"name":"测试部门1","parentId":18061400012,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1006238","path":[18061400012,18061900084],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18062000003,"name":"辰森供应链_配送中心","parentId":18061400018,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1004007","path":[18061400012,18061400017,18061400018,18062000003],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18062000005,"name":"辰森测试部门","parentId":18061400012,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1004080","path":[18061400012,18062000005],"checkedStoreIds":[],"allStoreIds":[18061400013],"checkedNum":0,"allNum":1},{"id":18062000006,"name":"辰森测试配送中心1","parentId":18062000005,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1004083","path":[18061400012,18062000005,18062000006],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18062000093,"name":"aaaaaaaeee3333","parentId":18061400016,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1005887","path":[18061400012,18061400016,18062000093],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0},{"id":18062000097,"name":"bbb","parentId":18061400012,"orgType":124,"disabled":false,"checked":false,"alipStoId":"1005931","path":[18061400012,18062000097],"checkedStoreIds":[],"allStoreIds":[18061400014],"checkedNum":0,"allNum":1},{"id":18062000107,"name":"测试123","parentId":18061400016,"orgType":122,"disabled":false,"checked":false,"alipStoId":"1006226","path":[18061400012,18061400016,18062000107],"checkedStoreIds":[],"allStoreIds":[],"checkedNum":0,"allNum":0}]};
var shopSource = source.body

// var quene = [rootDomain]
// var currentNode = quene.shift() 
// while(currentNode) {
//     shopSource.forEach(e => {
//         if (e.parentId === currentNode.id) {
//             // currentNode.children = []
//             // currentNode.children.push(e)
//             quene.push(e)
//         }
//     })
//     currentNode.children = quene
//     console.log(currentNode)
//     currentNode = quene.shift()   
// }
var orgTreeBF = function (data, parentId) {
    var children = data.find(item => item.parentId == parentId)
    var quene = []
    quene.push(children)
    var parentNode = quene.shift()

    while(parentNode) {
        var childrens = data.filter(item => item.parentId == parentNode.id)
        quene = quene.concat(childrens)
        parentNode = quene.shift()
    }
    return parentNode
}
var newSource = orgTreeBF(shopSource, null)
console.log(newSource)
/**
 * 递归 深度遍历
 */
// var getJsonTree = function(data, parentId) {
//     var itemArr = []
//     for (var i = 0; i < data.length; i++) {
//         var node = data[i]
//         if (node.parentId == parentId) {
//             var newNode = {...node}
//             newNode.children = getJsonTree(data, node.id)
//             itemArr.push(newNode);
//         }
//     }
//     return itemArr;
// }
// var newSource = getJsonTree(shopSource, null)
// console.log(newSource)

/**
 * air-chain-common
 */
// 根节点添加isRoot属性
// shopSource.some((item) => {
//     if (item.orgType === 0 || item.orgType === null) {
//         item.isRoot = true
//         item.orgType = 0 // 处理orgType === null的情况
//         return true
//     }
// })
// // 用node的id和index生成一个map
// // 赋值根节点
// var maps = {}
// var rootNode = null
// shopSource.forEach((node, index) => {
//     maps[node.id] = index
//     if (node.isRoot) {
//         rootNode = node
//     }
// })
// // 过滤并且组成一个数组tree
// shopSource = shopSource.filter(node => {
//     if ([0, 121, 122, 124, 125, 126].includes(node.orgType)) { // 剔除orgType不在当前范围中的
//         if (!node.isRoot) {
//             const parentNode = shopSource[maps[node.parentId]] // 更具map找到当前node对应的parentNode
//             const children = parentNode.children || [] // 获取parentNode的children对象
//             children.push(node) // node节点存储到children中，这儿仅仅存储的是node的指针
//             parentNode.children = children
//         }
//         return true
//     }
// })